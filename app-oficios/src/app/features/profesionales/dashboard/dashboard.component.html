<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-top">
      <button class="back-btn" (click)="goBack()">
        <lucide-angular [img]="ArrowLeft" size="20"></lucide-angular>
        <span>Volver al Inicio</span>
      </button>
      <button class="logout-btn" (click)="logout()" title="Cerrar sesión">
        <lucide-angular [img]="LogOut" [size]="20"></lucide-angular>
        <span>Cerrar sesión</span>
      </button>
    </div>
    <div class="header-content">
      <h1>Dashboard Profesional</h1>
      <p class="welcome-text">Bienvenido, <strong>{{ userName() }}</strong></p>
    </div>
  </header>

  <!-- Metrics Grid -->
  <section class="metrics-section">
    <h2 class="section-title">Resumen de Métricas</h2>
    <div class="metrics-grid">
      <div *ngFor="let metric of metrics()" class="metric-card">
        <div class="metric-icon">
          <lucide-angular [img]="metric.icon" size="24"></lucide-angular>
        </div>
        <div class="metric-content">
          <p class="metric-title">{{ metric.title }}</p>
          <h3 class="metric-value">{{ metric.value }}</h3>
          <div class="metric-change" [class.positive]="metric.trend === 'up'" [class.negative]="metric.trend === 'down'">
            <lucide-angular [img]="TrendingUp" size="14"></lucide-angular>
            <span>{{ metric.change }} vs mes anterior</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Solicitudes Pendientes -->
  <section class="solicitudes-section" *ngIf="solicitudesPendientes().length > 0 || isLoadingSolicitudes()">
    <div class="section-header">
      <h2 class="section-title">
        <lucide-angular [img]="AlertCircle" size="24"></lucide-angular>
        Solicitudes Pendientes
      </h2>
      <span class="badge-count">{{ solicitudesPendientes().length }}</span>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoadingSolicitudes()" class="loading-container">
      <p>Cargando solicitudes...</p>
    </div>

    <!-- Solicitudes List -->
    <div *ngIf="!isLoadingSolicitudes()" class="solicitudes-grid">
      <div *ngFor="let solicitud of solicitudesPendientes()" class="solicitud-card">
        <div class="solicitud-header">
          <div class="client-info">
            <lucide-angular [img]="Users" size="20"></lucide-angular>
            <h3>{{ solicitud.nombreUsuario }}</h3>
          </div>
          <span class="time-badge">{{ formatTime(solicitud.fechasolicitud) }}</span>
        </div>

        <div class="solicitud-body">
          <div class="info-row">
            <lucide-angular [img]="Calendar" size="16"></lucide-angular>
            <span><strong>Fecha de servicio:</strong> {{ formatDate(solicitud.fechaservicio) }}</span>
          </div>

          <div class="info-row" *ngIf="solicitud.direccion">
            <lucide-angular [img]="FileText" size="16"></lucide-angular>
            <span><strong>Dirección:</strong> {{ solicitud.direccion }}</span>
          </div>

          <div class="observaciones">
            <strong>Observaciones:</strong>
            <p>{{ solicitud.observacion }}</p>
          </div>
        </div>

        <div class="solicitud-actions">
          <button
            class="btn btn-reject"
            (click)="responderSolicitud(solicitud.idSolicitud, false)"
            [disabled]="respondingToSolicitud() === solicitud.idSolicitud"
          >
            <lucide-angular [img]="XIcon" size="18"></lucide-angular>
            <span>Rechazar</span>
          </button>
          <button
            class="btn btn-accept"
            (click)="responderSolicitud(solicitud.idSolicitud, true)"
            [disabled]="respondingToSolicitud() === solicitud.idSolicitud"
          >
            <lucide-angular [img]="Check" size="18"></lucide-angular>
            <span>{{ respondingToSolicitud() === solicitud.idSolicitud ? 'Procesando...' : 'Aceptar' }}</span>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Actions -->
  <section class="actions-section">
    <h2 class="section-title">Acciones Rápidas</h2>
    <div class="actions-grid">
      <div class="action-card" (click)="goToInvoices()">
        <div class="action-icon invoices">
          <lucide-angular [img]="FileText" size="32"></lucide-angular>
        </div>
        <h3>Facturas</h3>
        <p>Ver y gestionar tus facturas generadas</p>
      </div>

      <div class="action-card" (click)="goToReviews()">
        <div class="action-icon reviews">
          <lucide-angular [img]="Star" size="32"></lucide-angular>
        </div>
        <h3>Reseñas</h3>
        <p>Consultar valoraciones y comentarios de clientes</p>
      </div>

      <div class="action-card" (click)="goToMessages()">
        <div class="action-icon messages">
          <lucide-angular [img]="MessageSquare" size="32"></lucide-angular>
        </div>
        <h3>Mensajería</h3>
        <p>Chat con clientes y gestión de conversaciones</p>
      </div>

      <div class="action-card" (click)="goToPaymentMethods()">
        <div class="action-icon payments">
          <lucide-angular [img]="CreditCard" size="32"></lucide-angular>
        </div>
        <h3>Métodos de Pago</h3>
        <p>Agregar y gestionar formas de cobro</p>
      </div>
    </div>
  </section>

  <!-- Recent Activity -->
  <section class="activity-section">
    <h2 class="section-title">Actividad Reciente</h2>
    <div class="activity-list">
      <div *ngFor="let activity of recentActivities()" class="activity-item">
        <div class="activity-icon">
          <lucide-angular [img]="activity.icon" size="20"></lucide-angular>
        </div>
        <div class="activity-content">
          <p class="activity-description">{{ activity.description }}</p>
          <span class="activity-time">{{ activity.time }}</span>
        </div>
      </div>
    </div>
  </section>
</div>
